
# üì° Documenta√ß√£o da API - Sistema de Gest√£o de Drones

Esta √© a documenta√ß√£o t√©cnica dos endpoints do backend (`Node.js/Express`), respons√°vel pela simula√ß√£o log√≠stica, regras de neg√≥cio e persist√™ncia em mem√≥ria.

## ‚ÑπÔ∏è Informa√ß√µes Gerais

* **URL Base:** `http://localhost:3000`
* **Autentica√ß√£o:** Nenhuma (API p√∫blica para fins de simula√ß√£o).
* **Formato dos Dados:** * Requisi√ß√µes (`POST`): `Content-Type: application/json`.
    * Respostas: Sempre em formato JSON.

---

## üì¶ Estrutura dos Dados

### 1. Objeto de Dashboard (Retorno Principal)

O endpoint `/dashboard` retorna o "snapshot" (estado atual) da simula√ß√£o. O Frontend consome este endpoint a cada 1 segundo (polling).

```json
{
  "metricas": {
    "entregas": 12,
    "viagens": 5,
    "eficiencia": "100%",
    "droneEficiente": "4562256",
    "tempoMedio": "45 seg"
  },
  "drones": [
    {
      "id": "4562256",
      "status": "EM_VOO",
      "capacidadeRestante": 8.50,
      "bateria": "Alta",
      "bateriaPercentual": 85,
      "rota": "Pr√≥ximo ao Destino",
      "lat": -19.9208,
      "lng": -43.9378,
      "eta": "45 s", 
      "pedidos": []
    }
  ],
  "pedidos": [
    {
      "id": "uuid-1234",
      "endereco": "Av. Amazonas, 100",
      "peso": 2.5,
      "prioridade": "Alta",
      "status": "Em transporte"
    }
  ],
  "historico": [
    {
      "id": "uuid-5678",
      "endereco": "Pra√ßa da Liberdade",
      "entregueEm": "14:30:00",
      "tempoTotal": "52s",
      "status": "Conclu√≠do"
    }
  ]
}
````

### 2\. Status Poss√≠veis do Pedido

O ciclo de vida de um pedido segue este fluxo:

1.  **`Aguardando`** (Fila de espera)
2.  **`Em Preparo`** (Separando carga na base)
3.  **`Carregando`** (Colocando no drone)
4.  **`Em transporte`** (Drone em voo)
5.  **`Entregue` / `Conclu√≠do`** (Finalizado)

-----

## üöÄ Endpoints de Pedidos

Gerenciam a entrada de novas demandas log√≠sticas.

### `POST /pedidos`

  * **Prop√≥sito:** Cadastra uma nova entrega na fila de prioridade.
  * **Regras de Neg√≥cio:**
      * Peso m√°ximo: **12kg**.
      * Campos obrigat√≥rios: Endere√ßo, Coordenadas, Peso.

**Corpo da Requisi√ß√£o (JSON):**

```json
{
  "endereco": "Av. Afonso Pena, 1500",
  "bairro": "Centro",
  "numero": "1500",
  "coordenadas": {
    "lat": -19.9245,
    "lng": -43.9352
  },
  "peso": 5.5,
  "prioridade": "Alta"
}
```

  * **Resposta de Sucesso (201 Created):**

<!-- end list -->

```json
{
  "mensagem": "Pedido criado e processado.",
  "pedido": {
    "id": "uuid-gerado...",
    "status": "Aguardando",
    ...
  }
}
```

  * **Resposta de Erro (400 Bad Request):**

<!-- end list -->

```json
{
  "erro": "Peso excede a capacidade m√°xima do drone (12kg)."
}
```

-----

## üìä Endpoints de Monitoramento

Fornecem dados em tempo real para a interface visual.

### `GET /dashboard`

  * **Prop√≥sito:** Retorna o estado completo da frota, filas e m√©tricas.

  * **Detalhes:** Inclui o c√°lculo de **ETA** (Estimativa de Tempo de Chegada) para cada drone e o n√≠vel exato de bateria.

  * **Resposta de Sucesso (200 OK):** Retorna o Objeto de Dashboard (ver estrutura acima).

### `GET /health`

  * **Prop√≥sito:** Health check para verificar se a API est√° online.

  * **Resposta de Sucesso (200 OK):**

<!-- end list -->

```json
{
  "status": "API Drones Online üöÅ",
  "time": "2023-12-10T14:00:00.000Z"
}
```

```
```
